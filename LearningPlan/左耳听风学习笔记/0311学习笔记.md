# 左耳听风-0311学习笔记

## 分布式系统的关键技术：服务调度
服务调度关键技术
- 服务关键程度
- 服务依赖关系
- 服务发现
- 整个架构的版本管理
- 服务应用生命周期全管理
### 服务关键程度和服务的依赖关系
服务关键程度需要我们梳理和定义服务的重要程度，而这需要细致地管理对业务的理解，才能定义出架构中各个服务的重要程度。（所以我们程序员还是需要了解业务的，不能仅仅停留则我们要负责开发的那一个功能模块）
我们还要梳理出服务间的依赖关系，这点也非常重要（之前我们做微服务开发时就没处理好，出现了循环依赖，最后是通过引入消息队列解除的循环依赖）。
微服务是服务依赖最优解的上限，而服务依赖的下限是千万不要有依赖环（也就是循环依赖）。
服务的依赖关系可以通过全链路监控来发现，比如使用zipkin。
有了服务的服务的重要程度和服务依赖关系之后，我们就相当于知道了整个架构的全局。
### 服务状态和生命周期的管理
有了架构的全局还需要一个服务发现的中间件。来知道这几件事：
- 整个架构中有多少种服务？
- 这些服务的版本是什么样的？
- 每个服务的实例数有多少个，它们的状态是什么样的？
- 每个服务的状态是什么样的？是在部署中，运行中，故障中，升级中，还是在回滚中，伸缩中，或者是下线中......
现在常用的注册与发现中心是nacos。
服务的生命周期通常会有的几个状态：
- Provision，代表在供应一个新的服务
- Ready，表示启动成功了
- Update，表示在升级中
- Rollback，表示在回滚中
- Scale，表示在伸缩中（可以有Scale-in和Scale-out两种）
- Destroy，表示在销毁中
- Failed，表示失败状态

### 整个架构的版本管理
因为各个服务的更新频率和依赖不一样，我们需要一个上层架构的版本管理。我们在需要回滚一个服务的版本时，就可以把与之有版本依赖的服务样也一起回滚掉。
### 资源/服务调度
服务和资源调度的过程，主要有以下关键技术。
- 服务状态的维持和拟合
- 服务的弹性伸缩和故障迁移
- 作业和应用调度
- 作业工作流编排
- 服务编排
docker和k8s 帮我们把这些工作中的大部分给做了。


此文章为3月Day5学习笔记，内容来源于：极客时间《左耳听风》，强烈推荐此课程。

![](../../img/20230306234244.jpg)